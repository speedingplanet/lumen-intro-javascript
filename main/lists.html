<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Working with lists</title>
    <style>
      #output span {
        cursor: pointer;
      }
      .underline {
        text-decoration: underline;
      }
      .red {
        background-color: red;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>Working with lists</h1>
    </header>

    <div>
      <div>
        <!-- 
          How can we add JavaScript code such that when the "Add Item" button
          is clicked, the item is added to the list of materials? 

          The item can be added to the end or beginning of the unordered list, no 
          need to sort it. (It should be sorted the next time the "Sort"
          button is clicked, of course.)
         -->

        <label for="add-item">Append an item:</label>
        <input type="text" id="add-item" />
        <button id="add-button">Add item</button>
      </div>
      <ul id="output"></ul>
      <div>
        <button id="sort-button">Sort</button>
        <button id="style-button">Underline</button>
      </div>
    </div>

    <script>
      const materials = [
        'canvas',
        'acrylics',
        'brushes',
        'turpentine',
        'frame',
        'brushes',
      ];

      const ul = document.getElementById('output');

      let items = materials.map((material) => {
        const li = document.createElement('li');
        // li.innerText = material;
        li.innerHTML = `<label><input type="checkbox"> ${material}</label> <span>❌</span>`;
        return li;

        /*
        const span = document.createElement('span');
        span.innerText = '❌';
        li.innerText = material + ' ';
        li.append(span);
        return li;
        */
      });

      ul.append(...items);

      ul.addEventListener('click', (event) => {
        if (event.target.tagName === 'SPAN') {
          let selectedItem = event.target.parentElement;
          ul.removeChild(selectedItem);
        }
      });

      /* One possibility
      ul.querySelectorAll('span').forEach((span) => {
        // attach event handler here 
        span.addEventListener('click', () => {});
      });
      */

      // TODO: get rid of items, use ul>li as the only container for data
      let reverseIt = false;
      document.getElementById('sort-button').addEventListener('click', () => {
        console.log('Sort the items');
        // Alternate: document.querySelectorAll('#output > li')
        let localItems = Array.from(ul.querySelectorAll('li'));
        if (reverseIt) {
          localItems.reverse();
        } else {
          localItems.sort((a, b) =>
            a.innerText.toUpperCase() < b.innerText.toUpperCase() ? -1 : 1
          );
        }
        ul.replaceChildren(...localItems);
        reverseIt = !reverseIt;
      });

      document.getElementById('add-button').addEventListener('click', () => {
        let textField = document.getElementById('add-item');
        if (textField.value === '') return;
        let item = textField.value;
        textField.value = '';

        const li = document.createElement('li');
        li.innerHTML = `<label><input type="checkbox"> ${item}</label> <span>❌</span>`;
        ul.append(li);
      });

      document.getElementById('style-button').addEventListener('click', () => {
        let checked = document.querySelectorAll(
          '#output input[type=checkbox]:checked'
        );
        checked.forEach((item) => {
          item.parentElement.classList.toggle('underline');
        });
        let unchecked = document.querySelectorAll(
          '#output input[type=checkbox]:not(:checked)'
        );
        unchecked.forEach((item) => {
          item.parentElement.classList.add('red');
        });
      });
    </script>
  </body>
</html>
